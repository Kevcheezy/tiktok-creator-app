# R1.5.5 - Engineering Roadmap Kanban Dashboard

**Date:** 2026-02-15
**Status:** APPROVED
**Priority:** P1 - Medium (Tier 1.5)
**Effort:** Medium

---

## Problem Statement

The engineering roadmap lives in `PRODUCT_ROADMAP.md` â€” a long markdown file that's hard to scan for current status. There's no way to see at a glance what's being worked on, by whom, or what's blocked. The admin must read through hundreds of lines to understand project state.

## Solution

A `/roadmap` page that parses `PRODUCT_ROADMAP.md` at render time into a live Kanban board with three columns (Backlog / In Progress / Done). Each task card shows its assigned worker â€” an FF7 character that represents a specific engineering domain. The markdown file remains the single source of truth.

---

## Design Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Data source | Parse PRODUCT_ROADMAP.md at render time | Markdown is the single source of truth, no sync drift |
| Worker assignment | Domain-based FF7 characters | Auto-assigns by task type, admin can override |
| Board layout | Status columns with worker avatars | Standard Kanban (Backlog / In Progress / Done), worker shown on each card |
| Scope | Engineering roadmap only | Future product-level roadmap will be a separate feature |

---

## Data Architecture

```
PRODUCT_ROADMAP.md (git-tracked, single source of truth)
        â†“
GET /api/roadmap
  â†’ Reads file from filesystem (server-side)
  â†’ Parses markdown into structured task objects
  â†’ Joins with roadmap_worker table for assignments
  â†’ Returns JSON array of tasks with status, tier, worker, progress
        â†“
/roadmap page (Kanban board)
  â†’ Renders 3 columns: Backlog | In Progress | Done
  â†’ Task cards with FF7 worker avatars
  â†’ Polls every 30s for live updates
```

### Markdown Parser Rules

The parser extracts tasks from `####` headers in the roadmap:

| Markdown Pattern | Parsed Status | Example |
|---|---|---|
| `#### ~~R1.1 - Title~~ DONE` | `done` | Strikethrough + DONE suffix |
| `#### ~~B0.1 - Title~~ FIXED` | `done` | Strikethrough + FIXED suffix |
| `#### R1.5.1 - Title ğŸ”§ IN PROGRESS` | `in_progress` | Wrench emoji + IN PROGRESS |
| `#### R1.7 - Title` (no marker) | `backlog` | No status marker |

### Task Fields Extracted

```typescript
interface RoadmapTask {
  id: string;              // "R1.7", "B0.10", "R1.5.1"
  title: string;           // "B-Roll Agent"
  tier: string;            // "0", "1", "1.5", "2", "3", "4"
  status: 'backlog' | 'in_progress' | 'done';
  priority: string;        // "P0", "P1", "P2", "P3"
  effort: string;          // "Small", "Medium", "Large", "Medium-Large"
  dependsOn: string[];     // ["R1.1", "B0.8"] â€” parsed from "Depends on:" line
  specPath: string | null; // "docs/plans/2026-02-15-r1.7-broll-agent-design.md"
  checkboxes: {
    total: number;         // Total [ ] + [x] checkboxes under this task
    completed: number;     // Count of [x] only
  };
  description: string;     // First sentence of "Why:" field
  costImpact: string | null; // Parsed from cost mentions (e.g., "$0.85-1.13/video")
  section: string;         // "Data model", "API", "Frontend", "Pipeline" â€” for auto-assignment
}
```

### Parser Implementation

```typescript
// Pseudo-code for the markdown parser
function parseRoadmap(markdown: string): RoadmapTask[] {
  const tasks: RoadmapTask[] = [];

  // Split by #### headers
  // For each header:
  //   1. Extract task ID (R1.7, B0.10, etc.) from header text
  //   2. Detect status from ~~strikethrough~~ DONE/FIXED or ğŸ”§ IN PROGRESS
  //   3. Parse "Priority:", "Effort:", "Depends on:", "Spec:", "Why:" fields
  //   4. Count [x] and [ ] checkboxes in the task body
  //   5. Extract tier from parent ### header ("Tier 0", "Tier 1", etc.)
  //   6. Detect cost mentions ($X.XX patterns)

  return tasks;
}
```

---

## FF7 Workers

### Character Roster

| Character | Role | Domain Keywords | Color Accent | Icon |
|-----------|------|----------------|--------------|------|
| **Cloud Strife** | Backend Lead | API, agent, worker, pipeline, queue, Supabase, migration, database | `#4A90D9` (steel blue) | Buster Sword |
| **Tifa Lockhart** | Frontend Lead | component, page, UI, styling, form, card, detail, list, storyboard | `#D94A6B` (crimson) | Boxing gloves |
| **Barret Wallace** | Infrastructure | logging, versioning, deploy, Redis, TLS, config, env, cost tracking | `#8B6914` (bronze) | Gun arm |
| **Aerith Gainsborough** | PM / Design | spec, roadmap, design, plan, UX, review, acceptance criteria | `#59B87A` (sage green) | Healing staff |
| **Red XIII** | QA / Review | test, validation, error handling, code review, guard, boundary | `#D97A2A` (flame orange) | Flame tail |

### Worker Assignment

**Auto-assignment heuristic:**
1. Parse the task's checklist items and sub-sections for domain keywords
2. Count keyword matches per worker
3. Assign to the worker with the highest match count
4. If tied or no matches: assign to **Aerith** (PM catches unclassified work)

**Manual override:**
- Admin can reassign any task via the board UI (dropdown on card)
- Override stored in `roadmap_worker` DB table
- Manual assignment takes precedence over auto-assignment

### `roadmap_worker` Table

| Column | Type | Description |
|--------|------|-------------|
| `id` | uuid (PK) | Auto-generated |
| `task_id` | text (unique) | Roadmap task ID (e.g., "R1.7", "B0.10") |
| `worker` | text | FF7 character name (cloud, tifa, barret, aerith, red_xiii) |
| `assigned_at` | timestamptz | When assigned |
| `assigned_by` | text | 'auto' or 'manual' |

---

## Kanban Board UI

### Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ENGINEERING ROADMAP                                    [Filter â–¾] ğŸ”  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ â˜ï¸ Cloud  â”‚ ğŸ‘Š Tifa  â”‚ ğŸ’ª Barretâ”‚ ğŸŒ¸ Aerithâ”‚ ğŸ”¥ Red   â”‚  [All]     â”‚
â”‚  â”‚ 3 tasks  â”‚ 2 tasks  â”‚ 0 tasks  â”‚ 1 task   â”‚ 0 tasks  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     BACKLOG (5)     â”‚  IN PROGRESS (2)    â”‚        DONE (14)           â”‚
â”‚                     â”‚                     â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â˜ï¸ Cloud   Tier 1â”‚â”‚ â”‚ ğŸ‘Š Tifa   Tier 1.5â”‚ â”‚ â˜ï¸ Cloud   Tier 1â”‚        â”‚
â”‚  â”‚                 â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â”‚ R1.7 B-Roll     â”‚â”‚ â”‚ R1.5.1 Inflcr  â”‚ â”‚ â”‚ ~~R1.1~~ Asset  â”‚        â”‚
â”‚  â”‚ Agent           â”‚â”‚ â”‚ Edit UI        â”‚ â”‚ â”‚ Generation      â”‚        â”‚
â”‚  â”‚                 â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 0%   â”‚â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 50% â”‚ â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% â”‚        â”‚
â”‚  â”‚ Depends: R1.1   â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                     â”‚                     â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â˜ï¸ Cloud   Tier 2â”‚â”‚ â”‚ ğŸŒ¸ Aerith Tier 2â”‚ â”‚ ğŸ’ª Barret  Tier 1â”‚        â”‚
â”‚  â”‚                 â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â”‚ R2.0 KPI        â”‚â”‚ â”‚ R2.5 Ref Video â”‚ â”‚ â”‚ ~~R1.4~~ Obs.   â”‚        â”‚
â”‚  â”‚ Dashboard       â”‚â”‚ â”‚ Intel Spec     â”‚ â”‚ â”‚ & Logging       â”‚        â”‚
â”‚  â”‚                 â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   â”‚â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 30% â”‚ â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% â”‚        â”‚
â”‚  â”‚ Depends: R1.2   â”‚â”‚ â”‚                 â”‚ â”‚ â”‚                 â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                     â”‚                     â”‚                             â”‚
â”‚  ...more cards...   â”‚                     â”‚ ...more cards (scrollable)..â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Worker Bar (Top)

Horizontal row of FF7 character avatars with active task counts. Clicking a character filters the board to show only their tasks. "All" shows everything.

### Task Card Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ï¸ Cloud Strife          Tier 1  â”‚  â† Worker avatar + name, tier badge
â”‚                                  â”‚
â”‚ R1.7 B-Roll Agent               â”‚  â† Task ID + title (bold)
â”‚ Two-phase B-roll planning and    â”‚  â† Description (truncated, 1 line)
â”‚ generation with storyboard...   â”‚
â”‚                                  â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 60%  (12/20)         â”‚  â† Progress bar from checkboxes
â”‚                                  â”‚
â”‚ ğŸ“ Spec  â›“ï¸ R1.1               â”‚  â† Spec link, dependency badges
â”‚ ğŸ’° ~$1.13/video                 â”‚  â† Cost impact if present
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Card colors:**
- Border-left accent color matches the assigned worker's color
- Tier 0 bugs: magenta left border (regardless of worker)
- Done cards: muted/faded styling

**Card interactions:**
- **Click:** Expand to show full task detail (all checkboxes, description, spec link, depends-on chain)
- **Worker dropdown:** Reassign to different FF7 character (PATCH /api/roadmap/assign)

### Filters

| Filter | Options |
|--------|---------|
| Worker | Cloud, Tifa, Barret, Aerith, Red XIII, All |
| Tier | 0, 1, 1.5, 2, 3, 4, All |
| Search | Free text search on task ID and title |

### Animations

- Cards slide smoothly between columns when status changes (on poll refresh)
- New cards fade in when added to the roadmap
- Worker avatars pulse subtly when they have in-progress work
- Progress bars animate on update

---

## API Endpoints

| Method | Route | Description |
|--------|-------|-------------|
| `GET` | `/api/roadmap` | Parse PRODUCT_ROADMAP.md â†’ JSON array of `RoadmapTask` objects |
| `GET` | `/api/roadmap/workers` | List FF7 workers with current task counts and assignments |
| `PATCH` | `/api/roadmap/assign` | Override worker assignment: `{ taskId: "R1.7", worker: "cloud" }` |

### GET /api/roadmap Response Shape

```typescript
{
  tasks: RoadmapTask[],
  summary: {
    total: number,
    backlog: number,
    in_progress: number,
    done: number,
    byTier: Record<string, number>,
    byWorker: Record<string, { total: number, in_progress: number, done: number }>
  },
  lastCommit: {
    hash: string,
    message: string,
    date: string
  }
}
```

### Markdown Parser Edge Cases

| Case | Handling |
|---|---|
| Nested checkboxes under a `[x]` parent | Count all checkboxes flat (don't nest) |
| Tasks with no checkboxes | Progress = `done` if status is done, else 0% |
| `Depends on: ~~B0.8~~` (crossed out dep) | Parse as resolved dependency (show as green) |
| Multiple tasks with same ID prefix | Use full header text for uniqueness |
| Tier headers without tasks | Skip (no cards rendered) |

---

## Frontend Components

| Component | File | Purpose |
|-----------|------|---------|
| `RoadmapBoard` | `src/components/roadmap-board.tsx` | Main Kanban board with 3 columns |
| `TaskCard` | `src/components/roadmap-task-card.tsx` | Individual task card with worker avatar |
| `WorkerBar` | `src/components/worker-bar.tsx` | Top bar with FF7 character filter chips |
| `TaskDetail` | `src/components/roadmap-task-detail.tsx` | Expanded view when card is clicked |

### Page Route

`/roadmap` â€” new page at `src/app/roadmap/page.tsx`

### Navigation

Add "Roadmap" tab to `nav.tsx` (after Influencers, before any admin section).

---

## Acceptance Criteria

### Backend
- [ ] Markdown parser: extracts task ID, title, status, tier, priority, effort, dependencies, spec path, checkboxes, description, cost impact from PRODUCT_ROADMAP.md
- [ ] `GET /api/roadmap` returns parsed tasks + summary statistics + last git commit info
- [ ] `GET /api/roadmap/workers` returns FF7 worker list with task counts
- [ ] `PATCH /api/roadmap/assign` stores/updates worker override in `roadmap_worker` table
- [ ] `roadmap_worker` table created via Supabase migration
- [ ] Auto-assignment heuristic: domain keywords â†’ FF7 character mapping
- [ ] Parser handles all edge cases: no checkboxes, crossed-out deps, nested content

### Frontend
- [ ] `/roadmap` page with Kanban board (3 columns: Backlog, In Progress, Done)
- [ ] Worker bar with FF7 character avatars and active task counts
- [ ] Task cards with worker avatar, tier badge, progress bar, dependencies, cost
- [ ] Card click expands to full detail view (all checkboxes, spec link, description)
- [ ] Worker reassignment dropdown on cards
- [ ] Filter by worker (click avatar in worker bar)
- [ ] Filter by tier (dropdown)
- [ ] Search by task ID/title
- [ ] Auto-poll every 30 seconds for live updates
- [ ] Smooth animations: card column transitions, progress bar updates, fade-in for new cards
- [ ] Dark cinematic theme consistent with rest of app
- [ ] Worker avatar pulse animation when worker has in-progress tasks
- [ ] "Roadmap" tab in navigation

### Data Integrity
- [ ] Board always reflects current state of PRODUCT_ROADMAP.md (no stale data)
- [ ] Manual worker assignments persist across page refreshes (stored in DB)
- [ ] Auto-assignment only applies when no manual override exists

---

## Parallel Work Analysis

```
PARALLEL WORK ANALYSIS:

- Task A (backend): Markdown parser library + GET /api/roadmap endpoint
  Files: src/lib/roadmap-parser.ts (NEW), src/app/api/roadmap/route.ts (NEW)
  Independent: YES

- Task B (backend): roadmap_worker table + assignment API + auto-assign heuristic
  Files: Supabase migration, src/app/api/roadmap/assign/route.ts (NEW),
         src/app/api/roadmap/workers/route.ts (NEW), src/lib/constants.ts
  Independent: YES (no dependency on parser)

- Task C (frontend): Kanban board + task cards + worker bar
  Files: src/components/roadmap-board.tsx, src/components/roadmap-task-card.tsx,
         src/components/worker-bar.tsx, src/app/roadmap/page.tsx, src/components/nav.tsx
  BLOCKED by Task A (needs API to fetch data)
  CAN START: UI shell with mocked data

- Task D (frontend): Task detail expand + worker reassignment + filters
  Files: src/components/roadmap-task-detail.tsx, updates to roadmap-board.tsx
  BLOCKED by Task A + B + C (needs API + base board)

Recommendation:
  Step 1: Task A + Task B in parallel (parser + worker system â€” independent)
  Step 2: Task C (board UI, wired to real API)
  Step 3: Task D (detail view, filters, reassignment)
```
